











<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html id="top" xmlns="http://www.w3.org/1999/xhtml">

<head>
  <title>
    RSF Wiki: IDDefunnellingReshaper
  </title>
  











<link rel="stylesheet" media="screen, projection, print" type="text/css"
     href="templates/default/jspwiki.css"/>

<link rel="stylesheet" type="text/css" media="print" 
     href="templates/default/jspwiki_print.css" />
<!-- INCLUDERESOURCES (stylesheet) -->

<!-- INCLUDERESOURCES (inlinecss) -->



<noscript>
<style type="text/css">
#hiddenmorepopup { display:block; }
</style>
</noscript>


<script type="text/javascript" src="scripts/mootools.js"></script>
<script type="text/javascript" src="scripts/prettify.js"></script>
<script type="text/javascript" src="scripts/jspwiki-common.js"></script>
<script type="text/javascript" src="scripts/jspwiki-commonstyles.js"></script>
<!-- INCLUDERESOURCES (script) -->





<meta name="wikiContext" content='view' />
<meta name="wikiBaseUrl" content='http://rsf.fluidproject.org/wiki/' />
<meta name="wikiPageUrl" content='/wiki/Wiki.jsp?page=%23%24%25' />
<meta name="wikiEditUrl" content='/wiki/Edit.jsp?page=IDDefunnellingReshaper' />
<meta name="wikiJsonUrl" content='/wiki/JSON-RPC' />
<meta name="wikiPageName" content='IDDefunnellingReshaper' />
<meta name="wikiUserName" content='205.211.169.35' />
<meta name="wikiTemplateUrl" content='/wiki/templates/default/' />
<meta name="wikiApplicationName" content='RSF Wiki' />

<script type="text/javascript">//<![CDATA[
/* Localized javascript strings: LocalizedStrings[] */
var LocalizedStrings = {
"javascript.edit.allsections":"( All )",
"javascript.slimbox.error":"<h2>Error</h2>There was a problem with your request.<br />Please try again",
"javascript.slimbox.remoteRequest":"Remote Request {0} of {1}",
"javascript.slimbox.close":"Close &#215;",
"javascript.quick.edit":"[Edit]",
"javascript.sort.descending":"Descending order. Click to reverse sort order",
"javascript.expand":"Click to expand",
"javascript.group.validName":"Please provide a valid name for the new Group",
"javascript.slimbox.next":"Next&raquo;",
"javascript.filter.all":"( All )",
"javascript.edit.areyousure":"Without clicking the Save button, your changes will be lost. Are you sure you want to exit this page?",
"javascript.quick.edit.title":"Edit section {0}...",
"javascript.slimbox.directLink":"Direct Link to the target",
"javascript.prefs.areyousure":"Without clicking the Save User Preferences button, your changes will be lost. Are you sure you want to exit this page?",
"javascript.sbox.clone.suffix":"-New",
"javascript.slimbox.info":"Image {0} of {1}",
"javascript.tip.default.title":"More...",
"javascript.edit.resize":"Drag to resize the text area",
"javascript.edit.findandreplace.nomatch":"No match found!",
"javascript.sort.ascending":"Ascending order. Click to reverse sort order",
"javascript.slimbox.close.title":"Close [Esc]",
"javascript.edit.toolbar.makeSelection":"Please make first a selection.",
"javascript.favs.hide":"Click to hide Favorites",
"javascript.sectionediting.label":"Section Overview",
"javascript.slimbox.previous":"&laquo;Previous",
"javascript.favs.show":"Click to show Favorites",
"javascript.collapse":"Click to collapse",
"javascript.category.title":"Click to show category [{0}] ...",
"javascript.sort.click":"Click to sort",
"javascript.edit.startOfPage":"( Start of page )"
};


/* INCLUDERESOURCES (jsfunction) */

//]]></script>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="search" href="Wiki.jsp%3Fpage=FindPage.html"
    title='Search RSF Wiki' />
<link rel="help"   href="Wiki.jsp%3Fpage=TextFormattingRules.html"
    title="Help" />

 <link rel="start"  href="Wiki.jsp%3Fpage=Main.html"
    title="Front page" />
<link rel="alternate stylesheet" type="text/css" href="templates/default/jspwiki_print.css"
    title="Print friendly" />
<link rel="alternate stylesheet" type="text/css" href="templates/default/jspwiki.css"
    title="Standard" />
<link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico" />

<link rel="icon" type="image/x-icon" href="images/favicon.ico" />



  









  
  
  
</head>

<body class="view">

<div id="wikibody" class="fav-left">
 
  






<div id="header">

  <div class="titlebox"></div>

  <div class="applicationlogo" > 
    <a href="Wiki.jsp%3Fpage=Main.html"
       title="Go to home page Main ">Home</a>
  </div>

  <div class="companylogo"></div>

  






<div class="userbox">

  
    <span class="username anonymous">
      G&#8217;day (anonymous guest)
    </span>
  
  
  

  
  
  
    
      <a href="Login.jsp%3Fredirect=IDDefunnellingReshaper.html" 
        class="action login"
        title="Log in or Register as new user">Log in</a>
    
  
  
  
  

  
  
    <a href="UserPreferences.jsp%3Fredirect=IDDefunnellingReshaper.html"
      class="action prefs" accesskey="p"
      title="Manage your preferences [ p ]">My <span class='accesskey'>P</span>refs
    </a>
  
  

  <div class="clearbox"></div>

</div>

  <div class="pagename">IDDefunnellingReshaper</div>

  <div class="searchbox">






<form action="http://xen0.idrc.ocadu.ca/wiki/Search.jsp"
        class="wikiform"
           id="searchForm" accept-charset="UTF-8">

  <div style="position:relative">
  <input onblur="if( this.value == '' ) { this.value = this.defaultValue }; return true; "
        onfocus="if( this.value == this.defaultValue ) { this.value = ''}; return true; "
           type="text" value="Quick Navigation"
           name="query" id="query"
           size="20" 
      accesskey="f" />
  <button type="submit"
  		 name="searchSubmit" id="searchSubmit"
  		value="Go!"
  		title="Go!"></button>
  </div>
  <div id="searchboxMenu" style='visibility:hidden;'>
    <div id="searchTools">
      <a href="Wiki.jsp%3Fpage=IDDefunnellingReshaper.html#" id='quickView' class='action'
      onclick="SearchBox.navigate( '/wiki/Wiki.jsp?page=__PAGEHERE__','View the selected page' );"
        title="View the selected page">view</a>
      <a href="Wiki.jsp%3Fpage=IDDefunnellingReshaper.html#" id='quickEdit' class='action'
      onclick="SearchBox.navigate( '/wiki/Edit.jsp?page=__PAGEHERE__','Edit the selected page' );"
        title="Edit the selected page">edit</a>
      <a href="Wiki.jsp%3Fpage=IDDefunnellingReshaper.html#" id='quickClone' class='action'	
      onclick="return SearchBox.navigate( '/wiki/Edit.jsp?page=__PAGEHERE__', 'Clone the selected page', true );"
        title="Clone the selected page">clone</a>
      <a href="Wiki.jsp%3Fpage=IDDefunnellingReshaper.html#" id="advancedSearch" class='action'
      onclick="SearchBox.navigate( 'http://rsf.fluidproject.org/wiki/Search.jsp?query=__PAGEHERE__','IDDefunnellingReshaper' )"
        title="Advanced Search [ f ]">find</a>
    </div>
    <div id="searchResult" >
	  Quick search
      <span id="searchTarget" >(type ahead)</span>
      <span id="searchSpin" class="spin" style="position:absolute;display:none;"></span>
	  <div id="searchOutput" ></div>
    </div>
    <div id="recentSearches" style="display:none;">
      Recent Searches
      <span><a href="Wiki.jsp%3Fpage=IDDefunnellingReshaper.html#" id="recentClear">(Clear)</a></span>
    </div>
  </div>

</form></div>

  <div class="breadcrumbs">Your trail:&nbsp;<a class="wikipage" href="Wiki.jsp%3Fpage=SWFforRSF.html">SWFforRSF</a>, <a class="wikipage" href="Wiki.jsp%3Fpage=PortingSellItemSWFSampleToRSF.html">PortingSellItemSWFSampleToRSF</a>, <a class="wikipage" href="Wiki.jsp%3Fpage=PortingShippingRateSWFSampleToRSF.html">PortingShippingRateSWFSampleToRSF</a>, <a class="wikipage" href="Wiki.jsp%3Fpage=HotelBookingSWFSample.html">HotelBookingSWFSample</a>, <a class="wikipage" href="Wiki.jsp%3Fpage=Continuations.html">Continuations</a>, <a class="wikipage" href="Wiki.jsp%3Fpage=Flows.html">Flows</a>, <a class="wikipage" href="Wiki.jsp%3Fpage=InformalFlows.html">InformalFlows</a>, <a class="wikipage" href="Wiki.jsp%3Fpage=NumberGuessing_3.html">NumberGuessing_3</a>, <a class="wikipage" href="Wiki.jsp%3Fpage=ResultingViewBindings.html">ResultingViewBindings</a>, <a class="wikipage" href="Wiki.jsp%3Fpage=EntityBeanLocator.html">EntityBeanLocator</a></div>

</div>

  <div id="content">

    <div id="page">
      





<div id="actionsTop" class="pageactions"> 
  <ul>

    
    
    

    
    <li id="morebutton">
      <a href="Wiki.jsp%3Fpage=MoreMenu.html" class="action more">More...</a>
    </li>

  </ul>
</div>

      








<div class="tabmenu">

  

  

  
  
  
    
  
    
  



  <a class="activetab" id="menu-pagecontent" accesskey="v" ><span class='accesskey'>V</span>iew</a>

  

  
  <a id="menu-attach" accesskey="a" ><span class='accesskey'>A</span>ttach</a>
  
    
  <a id="menu-info" href='PageInfo.jsp%3Fpage=IDDefunnellingReshaper.html' accesskey="i" ><span class='accesskey'>I</span>nfo</a>
    
  

</div>
<div class="tabs">

  <div id="pagecontent" >

    











<p>The &quot;ID Defunnelling Reshaper&quot; has a silly name, but it performs a simple task and is easy to use. It is implemented as standard in the RSF framework as a single, request-scope bean named <tt>id-defunnel</tt>, and it is used to handle the case where a selection control <a class="wikipage" href="Wiki.jsp%3Fpage=UISelect.html">UISelect</a> is allowing the user to select which instance of one entity type is attached to a different one.
</p><h4 id="section-IDDefunnellingReshaper-SamplePersistentModel">Sample persistent model<a class="hashlink" href="Wiki.jsp%3Fpage=IDDefunnellingReshaper.html#section-IDDefunnellingReshaper-SamplePersistentModel">#</a></h4>
Imagine we had a persistent model setup as follows (which is quite common when using ORM solutions such as Hibernate):
<pre>
public class Recipe {
  public String id;
  public Category category;
  ...
  }

public class Category {
  public String id;
  }
</pre>
<h4 id="section-IDDefunnellingReshaper-WhyTheReshaperHelps">Why the reshaper helps<a class="hashlink" href="Wiki.jsp%3Fpage=IDDefunnellingReshaper.html#section-IDDefunnellingReshaper-WhyTheReshaperHelps">#</a></h4>
A very common requirement would be a selection control that allowed the user to assign Recipes to different categories. Since RSF is aimed at a &quot;server-light&quot; model where nothing is held on the server between requests, the natural way to express this is as a UISelect control where the list of choices is between the <tt>id</tt> elements of the Categories rather than the entire objects themselves. However, when the form submission returns, we have a potentially irritating task (even more irritating if we are using full <a class="wikipage" href="Wiki.jsp%3Fpage=OTP.html">OTP</a>) of mapping the incoming Category id in the submission back on to the correct persistent entity, fetching it from persistence, and then assigning *it* rather than the id into the correct place in the Recipe object.
<h4 id="section-IDDefunnellingReshaper-SampleBackingModel">Sample backing model<a class="hashlink" href="Wiki.jsp%3Fpage=IDDefunnellingReshaper.html#section-IDDefunnellingReshaper-SampleBackingModel">#</a></h4>
<p>If we were using a simple &quot;pre-OTP&quot; model (here namely the &quot;captive entity pattern&quot;) we might have written a backing model like this:
</p>
<pre>
public class RecipeHandler {
  public Recipe newRecipe = new Recipe();
  }
</pre>
<h4 id="section-IDDefunnellingReshaper-HowToDeclareUseOfTheReshaper">How to declare use of the reshaper<a class="hashlink" href="Wiki.jsp%3Fpage=IDDefunnellingReshaper.html#section-IDDefunnellingReshaper-HowToDeclareUseOfTheReshaper">#</a></h4>
Now, assuming the <a class="wikipage" href="Wiki.jsp%3Fpage=EntityNameInferrer.html">EntityNameInferrer</a> is properly registered with the framework for the <tt>Category</tt> entity, we could set up a UISelect control which selects between different categories as simply as this:
<pre>
  ...
  List&lt;Category&gt; categories = categoryDao.fetchAllCategories();
  String[] catIds = new String[categories.size()];
  String[] catNames = new String[categories.size()];
  for (int i = 0; i &lt; categories.size(); ++ i) {
    catIds[i] = categories.get(i).id;
    catNames[i] = categories.get().name;
    }
  UISelect catSelect = UISelect.make(tofill, &quot;category-select&quot;, catIds, catNames, 
          &quot;recipeHandler.newRecipe.category.id&quot;).setIDDefunnel();
</pre>
<p>Note that the crucial directive to make sure that this &quot;selection control of ids&quot; as it has been formally set up is interpreted as a &quot;selection control of entities&quot; is to issue the call <tt>setIDDefunnel()</tt> at the end of the construction call.
</p>
<p>Note that if you are using the standard framework <a class="wikipage" href="Wiki.jsp%3Fpage=EntityBeanLocator.html">EntityBeanLocator</a> for <tt>Category</tt>, say, the relevant <a class="wikipage" href="Wiki.jsp%3Fpage=EntityNameInferrer.html">EntityNameInferrer</a> will be set up for you automatically.
</p>
<p>If we were also using <a class="wikipage" href="Wiki.jsp%3Fpage=OTP.html">OTP</a> for the <tt>Recipe</tt> entity itself, note that all that would change would be the EL path bound to the control - rather than the fixed path we had written as above, we would write <tt>&quot;Recipe.&quot;+recipeId+&quot;.category.id&quot;</tt>. Note that in future versions of RSF (probably 0.9) even this aspect of OTP will be automated and one will no longer need to compose OTP EL paths by hand in this way.
</p>
<h4 id="section-IDDefunnellingReshaper-NoteOnVersioning">Note on versioning<a class="hashlink" href="Wiki.jsp%3Fpage=IDDefunnellingReshaper.html#section-IDDefunnellingReshaper-NoteOnVersioning">#</a></h4>
Although <tt>id-defunnel</tt> has actually been part of RSF since the very earliest days (a buried use of it can be found in <a class="wikipage" href="Wiki.jsp%3Fpage=HibernateCookBook_3.html">page 3</a> and <a class="wikipage" href="Wiki.jsp%3Fpage=HibernateCookBook_4.html">page 4</a> of the original Hibernate Cookbook), the &quot;compact and automatic&quot; use shown above is new in RSF version 0.7.3. Before this version, the <tt>id-defunnel</tt> reshaper had to be written onto the UISelect <tt>selection</tt> member manually as a bean reference, and due to lack of an automated <a class="wikipage" href="Wiki.jsp%3Fpage=EntityBeanLocator.html">EntityBeanLocator</a>, correct implementations of <a class="wikipage" href="Wiki.jsp%3Fpage=EntityNameInferrer.html">EntityNameInferrer</a> were very rare.







        
  </div>


  

  
  <div id="attach" class="hidetab" >

    










<div id="addattachment">
<h3>Add new attachment</h3>


<div class="formhelp">Only authorized users are allowed to upload new attachments.</div>

</div>



  </div>

  
    
  <div id="info" class="hidetab" >

  </div>

    
  

<div style="clear:both;" ></div>
</div>

      







<div id='actionsBottom' class="pageactions"> 
    

    <a href="Wiki.jsp%3Fpage=IDDefunnellingReshaper.html#top" 
      class="action quick2top" 
      title="Go to top" >&laquo;</a>

    
       This page (revision-) was last changed on <a href="Diff.jsp%3Fpage=IDDefunnellingReshaper&amp;r1=-1&amp;r2=1.html">28-Jul-2008 15:14</a> by UnknownAuthor
    

    

   

  

   
</div>

    </div>

    






<div id="favorites">

  






<div class="userbox">

  
    <span class="username anonymous">
      G&#8217;day (anonymous guest)
    </span>
  
  
  

  
  
  
    
      <a href="Login.jsp%3Fredirect=IDDefunnellingReshaper.html" 
        class="action login"
        title="Log in or Register as new user">Log in</a>
    
  
  
  
  

  
  
    <a href="UserPreferences.jsp%3Fredirect=IDDefunnellingReshaper.html"
      class="action prefs" accesskey="p"
      title="Manage your preferences [ p ]">My <span class='accesskey'>P</span>refs
    </a>
  
  

  <div class="clearbox"></div>

</div>
  
  <div id="hiddenmorepopup">
  <ul id="morepopup">
     
       	
     
       
     
    
       
     
       <li>
       
       <a class="action rawpage wikipage" 
               href="Wiki.jsp%3Fpage=IDDefunnellingReshaper&amp;skin=raw.html"
              title="View Page Source">View Page Source
       </a>
       
       
       </li>
      
        
  
      
      
      

      
	  <li class='separator'>
        <div id="moremenu" ></div>
      </li>
  </ul>
  </div>
  
  

  

  

  
  <div class="leftmenu">
    <p><a class="wikipage" href="Wiki.jsp%3Fpage=Main.html">Main page</a><br />
<tt> </tt><i><a class="wikipage" href="Wiki.jsp%3Fpage=ThisWiki.html">About</a></i><br />
</p><p><a class="wikipage" href="Wiki.jsp%3Fpage=GettingStarted.html">Getting Started</a><br />
</p>
<p><b>Documentation</b><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=Developers.html">Developers</a><br />
<tt>  </tt><a class="wikipage" href="Wiki.jsp%3Fpage=Javadocs.html">Javadocs</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=Designers.html">Designers</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=SampleRSFApps.html">Sample RSF Apps</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=Presentations.html">Presentations</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=Acronyms.html">Acronyms</a><br />
</p>
<p><b>Downloads</b><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=Downloads.html">Current Release</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=TrunkCode.html">Trunk</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=CodeDistributions.html">Distributions</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=OldCode.html">Old Versions</a><br />
</p>
<p><b>Community</b><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=QampA.html">Q&amp;A</a><br />
<tt> </tt><a class="external" href="http://ponder.org.uk/rsf/">Forums</a><img class="outlink" src="images/out.png" alt="" /><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=EmailLists.html">Mailing Lists</a><br />
<tt> </tt><a class="external" href="http://www.caret.cam.ac.uk/jira/browse/RSF">Issue Tracker</a><img class="outlink" src="images/out.png" alt="" /><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=azeckoski.html">People</a><br />
</p>
<p><b>Design</b><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=Roadmap.html">Roadmap</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=Integrations.html">Integrations</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=Concepts.html">Concepts</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=Philosophy.html">Philosophy</a><br />
</p>
<div style="font-style:italic;font-size:0.8em;">
<b>Pages</b><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=FindPage.html">Find</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=RecentChanges.html">Recent Changes</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=UnusedPages.html">Unused</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=UndefinedPages.html">Undefined</a><br />
<tt> </tt><a class="wikipage" href="Wiki.jsp%3Fpage=PageIndex.html">Index</a>
</div>
<p />
    
  </div>
  
  <div class="leftmenufooter">
    <hr />
<p><b>Referenced by</b><br />
<a class="wikipage" href="Wiki.jsp%3Fpage=EntityBeanLocator.html">EntityBeanLocator</a><br /><a class="wikipage" href="Wiki.jsp%3Fpage=EntityNameInferrer.html">EntityNameInferrer</a><br /><a class="wikipage" href="Wiki.jsp%3Fpage=Roadmap.html">Roadmap</a><br />
</p>
    
  </div>

  

  
  
  <div class="wikiversion">JSPWiki v2.8.2
  <span class="rssfeed">
    
  </span>
  </div>  
  
</div>

	<div class="clearbox"></div>
  </div>

  





 
<div id="footer">

  <div class="applicationlogo" > 
    <a href="Wiki.jsp%3Fpage=Main.html"
       title="Go to home page Main ">Home</a>
  </div>

  <div class="companylogo"></div>

  <div class="copyright"></div>

  <div class="wikiversion">
    JSPWiki v2.8.2
  </div>

  <div class="rssfeed">
    
  </div>

</div>

</div>

</body>
</html>

